# fix attributes on new item
# @s = unidentified item
# at @s
# run from identification/run

execute store result score $set_slot gm4_ce_data run data get storage gm4_combat_expanded_armor:temp components."minecraft:custom_data".gm4_combat_expanded_armor.slot
execute if score $set_slot gm4_ce_data matches 0 run data modify storage gm4_combat_expanded_armor:temp new_components.set_slot set value "head"
execute if score $set_slot gm4_ce_data matches 1 run data modify storage gm4_combat_expanded_armor:temp new_components.set_slot set value "chest"
execute if score $set_slot gm4_ce_data matches 2 run data modify storage gm4_combat_expanded_armor:temp new_components.set_slot set value "legs"
execute if score $set_slot gm4_ce_data matches 3 run data modify storage gm4_combat_expanded_armor:temp new_components.set_slot set value "feet"

# merge components from base item
data modify storage gm4_combat_expanded_armor:temp new_components."minecraft:damage" merge from storage gm4_combat_expanded_armor:temp components."minecraft:damage"
data modify storage gm4_combat_expanded_armor:temp new_components."minecraft:attribute_modifiers".modifiers append from storage gm4_combat_expanded_armor:temp components."minecraft:attribute_modifiers".modifiers[]
data modify storage gm4_combat_expanded_armor:temp new_components."minecraft:enchantments" merge from storage gm4_combat_expanded_armor:temp components."minecraft:enchantments"
# set slots for attribute_modifiers
execute if data storage gm4_combat_expanded_armor:temp new_components."minecraft:attribute_modifiers".modifiers[{id:"gm4_combat_expanded_armor:permanent"}] run data modify storage gm4_combat_expanded_armor:temp new_components."minecraft:attribute_modifiers".modifiers[{id:"gm4_combat_expanded_armor:permanent"}].slot set from storage gm4_combat_expanded_armor:temp new_components.set_slot
execute if data storage gm4_combat_expanded_armor:temp new_components."minecraft:attribute_modifiers".modifiers[{id:"gm4_combat_expanded_armor:permanent_2"}] run data modify storage gm4_combat_expanded_armor:temp new_components."minecraft:attribute_modifiers".modifiers[{id:"gm4_combat_expanded_armor:permanent_2"}].slot set from storage gm4_combat_expanded_armor:temp new_components.set_slot
execute if data storage gm4_combat_expanded_armor:temp new_components."minecraft:attribute_modifiers".modifiers[{id:"gm4_combat_expanded_armor:permanent_3"}] run data modify storage gm4_combat_expanded_armor:temp new_components."minecraft:attribute_modifiers".modifiers[{id:"gm4_combat_expanded_armor:permanent_3"}].slot set from storage gm4_combat_expanded_armor:temp new_components.set_slot
execute if data storage gm4_combat_expanded_armor:temp new_components."minecraft:attribute_modifiers".modifiers[{id:"gm4_combat_expanded_armor:permanent_4"}] run data modify storage gm4_combat_expanded_armor:temp new_components."minecraft:attribute_modifiers".modifiers[{id:"gm4_combat_expanded_armor:permanent_4"}].slot set from storage gm4_combat_expanded_armor:temp new_components.set_slot
execute if data storage gm4_combat_expanded_armor:temp new_components."minecraft:attribute_modifiers".modifiers[{id:"gm4_combat_expanded_armor:permanent_5"}] run data modify storage gm4_combat_expanded_armor:temp new_components."minecraft:attribute_modifiers".modifiers[{id:"gm4_combat_expanded_armor:permanent_5"}].slot set from storage gm4_combat_expanded_armor:temp new_components.set_slot
execute if data storage gm4_combat_expanded_armor:temp new_components."minecraft:attribute_modifiers".modifiers[{id:"gm4_combat_expanded_armor:permanent_6"}] run data modify storage gm4_combat_expanded_armor:temp new_components."minecraft:attribute_modifiers".modifiers[{id:"gm4_combat_expanded_armor:permanent_6"}].slot set from storage gm4_combat_expanded_armor:temp new_components.set_slot
execute if data storage gm4_combat_expanded_armor:temp new_components."minecraft:attribute_modifiers".modifiers[{id:"gm4_combat_expanded_armor:permanent_7"}] run data modify storage gm4_combat_expanded_armor:temp new_components."minecraft:attribute_modifiers".modifiers[{id:"gm4_combat_expanded_armor:permanent_7"}].slot set from storage gm4_combat_expanded_armor:temp new_components.set_slot
execute if data storage gm4_combat_expanded_armor:temp new_components."minecraft:attribute_modifiers".modifiers[{id:"gm4_combat_expanded_armor:permanent_8"}] run data modify storage gm4_combat_expanded_armor:temp new_components."minecraft:attribute_modifiers".modifiers[{id:"gm4_combat_expanded_armor:permanent_8"}].slot set from storage gm4_combat_expanded_armor:temp new_components.set_slot
execute if data storage gm4_combat_expanded_armor:temp new_components."minecraft:attribute_modifiers".modifiers[{id:"gm4_combat_expanded_armor:permanent_9"}] run data modify storage gm4_combat_expanded_armor:temp new_components."minecraft:attribute_modifiers".modifiers[{id:"gm4_combat_expanded_armor:permanent_9"}].slot set from storage gm4_combat_expanded_armor:temp new_components.set_slot
execute if data storage gm4_combat_expanded_armor:temp new_components."minecraft:attribute_modifiers".modifiers[{id:"gm4_combat_expanded_armor:dynamic"}] run data modify storage gm4_combat_expanded_armor:temp new_components."minecraft:attribute_modifiers".modifiers[{id:"gm4_combat_expanded_armor:dynamic"}].slot set from storage gm4_combat_expanded_armor:temp new_components.set_slot
execute if data storage gm4_combat_expanded_armor:temp new_components."minecraft:attribute_modifiers".modifiers[{id:"gm4_combat_expanded_armor:dynamic_2"}] run data modify storage gm4_combat_expanded_armor:temp new_components."minecraft:attribute_modifiers".modifiers[{id:"gm4_combat_expanded_armor:dynamic_2"}].slot set from storage gm4_combat_expanded_armor:temp new_components.set_slot
execute if data storage gm4_combat_expanded_armor:temp new_components."minecraft:attribute_modifiers".modifiers[{id:"gm4_combat_expanded_armor:dynamic_3"}] run data modify storage gm4_combat_expanded_armor:temp new_components."minecraft:attribute_modifiers".modifiers[{id:"gm4_combat_expanded_armor:dynamic_3"}].slot set from storage gm4_combat_expanded_armor:temp new_components.set_slot
execute if data storage gm4_combat_expanded_armor:temp new_components."minecraft:attribute_modifiers".modifiers[{id:"gm4_combat_expanded_armor:dynamic_4"}] run data modify storage gm4_combat_expanded_armor:temp new_components."minecraft:attribute_modifiers".modifiers[{id:"gm4_combat_expanded_armor:dynamic_4"}].slot set from storage gm4_combat_expanded_armor:temp new_components.set_slot
# set levels from storages
execute if data storage gm4_combat_expanded_armor:temp new_components."minecraft:custom_data".gm4_combat_expanded_armor.level run function gm4_combat_expanded_armor:identification/set_value/level
execute if data storage gm4_combat_expanded_armor:temp new_components."minecraft:custom_data".gm4_combat_expanded_armor.level2 run function gm4_combat_expanded_armor:identification/set_value/level2
execute if data storage gm4_combat_expanded_armor:temp new_components."minecraft:custom_data".gm4_combat_expanded_armor.level3 run function gm4_combat_expanded_armor:identification/set_value/level3
